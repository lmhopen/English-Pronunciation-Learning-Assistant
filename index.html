<!-- templates/index.html -->
<!DOCTYPE html>
<html>
<head>
    <title>English Learning Tool</title>
    <meta charset="utf-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .sentence-container {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .english-text {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .speak-button {
            background-color: #4CAF50;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
        }
        .speak-button:hover {
            background-color: #45a049;
        }
        .speak-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        textarea {
            width: 100%;
            padding: 10px;
            font-family: Arial, sans-serif;
        }
        button {
            background-color: #008CBA;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #007B9A;
        }
        .speed-control {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f0f8ff;
        }
        .speed-slider {
            width: 100%;
            margin: 10px 0;
        }
        .speed-value {
            display: inline-block;
            width: 40px;
            text-align: center;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>English Learning Tool</h1>
    
    <!-- è¯­é€Ÿæ§åˆ¶åŒºåŸŸ -->
    <div class="speed-control">
        <label for="speedSlider">å‘éŸ³é€Ÿåº¦: 
            <span id="speedValue" class="speed-value">1.0</span>x
        </label>
        <input type="range" id="speedSlider" class="speed-slider" 
               min="0.5" max="2.0" step="0.1" value="1.0"
               oninput="updateSpeedValue()">
    </div>
    
    <div>
        <textarea id="inputText" rows="10" cols="80" placeholder="è¯·è¾“å…¥è‹±æ–‡å¥å­ï¼Œæ¯è¡Œä¸€å¥..."></textarea><br><br>
        <button onclick="processText()">å¤„ç†æ–‡æœ¬</button>
    </div>
    
    <div id="results"></div>

    <script>
        // å…¨å±€å˜é‡å­˜å‚¨å½“å‰è¯­é€Ÿ
        let currentSpeed = 1.0;
        
        // æ›´æ–°è¯­é€Ÿæ˜¾ç¤ºå€¼
        function updateSpeedValue() {
            const slider = document.getElementById('speedSlider');
            const valueDisplay = document.getElementById('speedValue');
            currentSpeed = parseFloat(slider.value);
            valueDisplay.textContent = currentSpeed.toFixed(1);
        }
        
        function processText() {
            const inputText = document.getElementById('inputText').value;
            const sentences = inputText.split('\n').filter(sentence => sentence.trim() !== '');
            
            // æ¸…ç©ºä¹‹å‰çš„ç»“æœ
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';
            
            // æ˜¾ç¤ºæ¯ä¸ªå¥å­
            sentences.forEach((sentence, index) => {
                const container = document.createElement('div');
                container.className = 'sentence-container';
                
                // åˆ¤æ–­æ˜¯å¦ä¸ºè‹±æ–‡å¥å­ï¼ˆåŒ…å«è‹±æ–‡å­—æ¯ä¸”ä¸ä»¥æ–œæ å¼€å¤´ï¼‰
                const isEnglishSentence = /[a-zA-Z]/.test(sentence) && !/^\/.*\/$/.test(sentence);
                
                if (isEnglishSentence) {
                    // åˆ›å»ºè‹±æ–‡æ–‡æœ¬å…ƒç´ 
                    const textSpan = document.createElement('span');
                    textSpan.textContent = sentence;
                    
                    // åˆ›å»ºå‘éŸ³æŒ‰é’®
                    const speakButton = document.createElement('button');
                    speakButton.className = 'speak-button';
                    speakButton.textContent = 'ğŸ”Š å‘éŸ³';
                    speakButton.onclick = function() {
                        speakText(sentence);
                    };
                    
                    // åˆ›å»ºåŒ…å«æ–‡æœ¬å’ŒæŒ‰é’®çš„å®¹å™¨
                    const englishTextDiv = document.createElement('div');
                    englishTextDiv.className = 'english-text';
                    englishTextDiv.appendChild(textSpan);
                    englishTextDiv.appendChild(speakButton);
                    
                    container.appendChild(englishTextDiv);
                } else {
                    // å¯¹äºéè‹±æ–‡è¡Œï¼ˆä¸­æ–‡ç¿»è¯‘æˆ–éŸ³æ ‡ï¼‰ï¼Œåªæ˜¾ç¤ºæ–‡æœ¬
                    const textDiv = document.createElement('div');
                    textDiv.className = 'english-text';
                    textDiv.textContent = sentence;
                    container.appendChild(textDiv);
                }
                
                resultsDiv.appendChild(container);
            });
        }
        
        function speakText(text) {
            // æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒè¯­éŸ³åˆæˆ
            if ('speechSynthesis' in window) {
                // åˆ›å»ºä¸€ä¸ªè¯­éŸ³å®ä¾‹
                const utterance = new SpeechSynthesisUtterance(text);
                
                // è®¾ç½®è¯­éŸ³å‚æ•°
                utterance.lang = 'en-US';      // è®¾ç½®ä¸ºè‹±è¯­
                utterance.rate = currentSpeed; // ä½¿ç”¨å¯è°ƒèŠ‚çš„è¯­é€Ÿ
                utterance.pitch = 1;           // éŸ³è°ƒ
                
                // æ’­æ”¾è¯­éŸ³
                window.speechSynthesis.speak(utterance);
            } else {
                alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆåŠŸèƒ½');
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–è¯­é€Ÿå€¼æ˜¾ç¤º
        window.onload = function() {
            updateSpeedValue();
        };
    </script>
</body>
</html>